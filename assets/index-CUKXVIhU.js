(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();const m="https://rickandmortyapi.com/api",p=m+"/character",a=document.getElementById("popup"),l=document.getElementById("characters__load_more");let i=p;console.log("Page loaded");const y=async e=>{let t=await fetch(e);if(!t.ok)throw t.status===404?new Error("No results for this search"):new Error(`Error HTTP: ${t.status}`);return await t.json()},d=async(e,t=!0)=>{const s=document.getElementById("characters__container"),o=document.getElementById("characters__spinner"),n=document.getElementById("characters__error");t&&(s.innerHTML=""),o.style.display="block",l.style.display="none",n.style.display="none";try{const r=await y(e);i=r.info?.next;for(let c of r.results)s.append(_(c))}catch(r){console.warn(r),n.style.display="block",i=null}finally{o.style.display="none",i&&(l.style.display="block")}},g=async e=>await(await fetch(e)).json(),f=e=>{a.querySelector("#popup__container__img").setAttribute("src",e.image);let s=a.querySelector("#popup__container__title");s.textContent=e.name;let o=a.querySelector("#popup__container__data"),n=e.episode.map(r=>r.split("episode/")[1]);o.innerHTML=`
        <p>Name: ${e.name}</p>
        <p>Gender: ${e.gender}</p>
        <p>Species: ${e.species}</p>
        <p>Status: ${e.status}</p>
        <p>Location: ${e.location.name}</p>
        <p>Origin: ${e.origin.name}</p>
        <p>Episode list: ${n.join(", ")}</p>
    `},h=async e=>{const t=document.getElementById("popup__container"),s=document.getElementById("popup__spinner");t.style.display="none",s.style.display="block",a.style.visibility="visible";let o=e.currentTarget.dataset.url,n=await g(o);console.log(`Clicked on: ${o}`),f(n),s.style.display="none",t.style.display="block"},_=e=>{let t=document.createElement("div");t.className="character",t.setAttribute("data-url",e.url);let s=document.createElement("img");s.className="character__img",s.setAttribute("src",e.image),t.append(s);let o=document.createElement("div");return o.className="character__data",o.innerHTML=`
        <p>Name: ${e.name}</p>
        <p>Gender: ${e.gender}</p>
        <p>Species: ${e.species}</p>
        <p>Status: ${e.status}</p>
    `,t.append(o),t.addEventListener("click",h),t},E=()=>{console.log("Clicked on popup close"),a.style.visibility="hidden"},u=()=>{let e=document.getElementById("search__bar").value,t=document.getElementById("status").value,s=document.getElementById("species").value,o=p+"/?name="+e;t&&(o+="&status="+t),s&&(o+="&species="+s),d(o),console.log(`Searched for: ${o}`)},L=()=>{console.log("Loading more characters"),d(i,!1)};document.getElementById("popup__container__close").addEventListener("click",E);document.getElementById("search").addEventListener("input",u);l.addEventListener("click",L);u();
